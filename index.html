<!DOCTYPE html>

<html lang="en">
<head>
<script>
  if (window.location.hostname === "amitoolatepodcast-lang.github.io") {
    window.location.href = "https://calculator.amitoolatepodcast.com";
  }
</script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Dream Life Calculator</title>
<style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        
        .calculator-container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        h1 {
            color: #2a6496;
            margin: 0;
            font-size: 28px;
        }
        
        .intro-text {
            margin-bottom: 30px;
            color: #555;
            font-size: 16px;
        }
        
        .podcast-btn {
            background: #2a6496;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .podcast-btn:hover {
            background: #1d4b7a;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        h2, h3 {
            color: #2a6496;
        }
        
        .category-section {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
            border-left: 4px solid;
            position: relative;
        }
        
        .needs {
            border-left-color: #22c55e;
        }
        
        .wants {
            border-left-color: #60a5fa;
        }
        
        .future {
            border-left-color: #f59e0b;
        }
        
        .expense-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 100px;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .expense-header {
            font-weight: bold;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
            margin-bottom: 15px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 100px;
            gap: 10px;
            color: #2a6496;
        }
        
        input, select {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            width: 100%;
            font-size: 14px;
        }
        
        input[type="number"] {
            text-align: right;
        }
        
        .results {
            background: #e8f0fe;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            font-size: 1.1em;
            padding: 10px 0;
            border-top: 1px solid #ccc;
        }
        
        .annual-row {
            display: flex;
            justify-content: space-between;
            font-size: 1em;
            padding: 5px 0;
            color: #555;
        }
        
        .btn {
            background: #2a6496;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #1d4b7a;
            transform: translateY(-2px);
        }
        
        .btn-danger {
             background: #dc3545;
        }
        .btn-danger:hover {
            background: #c82333;
        }

        .retirement-section {
            margin-top: 30px;
            padding: 20px;
            background: #f0f7ff;
            border-radius: 8px;
            border-left: 4px solid #2a6496;
        }
        
        .add-row-btn {
            background: #e8f0fe;
            color: #2a6496;
            border: 1px dashed #2a6496;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            display: inline-block;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .add-row-btn:hover {
            background: #d6e4ff;
        }
        
        .action-btn {
            background: #f0f0f0;
            color: #333;
            border: none;
            border-radius: 4px;
            padding: 5px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 2px;
            transition: all 0.2s;
        }

        .move-up {
            background: #e8f0fe;
            color: #2a6496;
        }
        
        .move-down {
            background: #e8f0fe;
            color: #2a6496;
        }
        
        .del-row {
            background: #fee2e2;
            color: #b91c1c;
        }
        
        .expense-name {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .build-pot-section h4 {
            font-size: 16px;
            border-bottom: 1px solid #d1e3f8;
            padding-bottom: 5px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .saved-scenario {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            border-left: 3px solid #2a6496;
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            background-color: #2a6496;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
            margin-left: 5px;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            line-height: 1.4;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Retirement tiers */
        .retirement-tiers {
            margin-top: 20px;
        }
        
        .retirement-tiers .tier {
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            background-color: white;
            border-left: 4px solid #2a6496;
        }
        
        .retirement-tiers .tier.minimum {
            border-left-color: #ef4444;
        }
        
        .retirement-tiers .tier.moderate {
            border-left-color: #f59e0b;
        }
        
        .retirement-tiers .tier.comfortable {
            border-left-color: #10b981;
        }
        
        .retirement-tiers .tier.dream {
            border-left-color: #8b5cf6;
        }
        
        .retirement-tiers small {
            display: block;
            color: #666;
            margin-top: 4px;
            font-size: 13px;
        }

        /* Multiplier badges */
        .multiplier-display {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            margin-bottom: 25px;
        }

        .multiplier-badge {
            flex: 1;
            padding: 15px;
            background: white;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #ddd;
            position: relative;
            transition: all 0.3s ease;
        }

        .multiplier-badge.active {
            border-color: #2a6496;
            box-shadow: 0 0 0 2px #2a6496;
        }

        .multiplier-badge:hover {
            background: #f5f7fa;
            border-color: #2a6496;
        }

        .multiplier-badge h4 {
            color: #2a6496;
            margin: 0 0 10px 0;
            font-size: 16px;
        }

        .multiplier-badge.active h4 {
            font-weight: bold;
        }

        .multiplier-badge p {
            font-size: 1.3em;
            margin: 10px 0;
            color: #333;
            font-weight: bold;
        }

        .multiplier-badge small {
            color: #666;
            font-size: 0.9em;
        }
        
        .multiplier-badge {
            /* Just keep the other styles */
        }
        /* Validation message */
        #validation-message {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 6px;
            border-left: 4px solid #ffc107;
        }
        
        /* Mobile responsive styles */
        @media (max-width: 768px) {
            .calculator-container {
                padding: 20px;
            }
            
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .podcast-btn {
                align-self: flex-start;
            }
            
            .expense-grid {
                grid-template-columns: 1fr;
                padding: 15px;
                background: #f8f9fa;
                margin-bottom: 20px;
                border-radius: 8px;
                border-left: 4px solid;
                gap: 15px;
            }
            
            .needs { border-left-color: #22c55e; }
            .wants { border-left-color: #60a5fa; }
            .future { border-left-color: #f59e0b; }

            .expense-grid > div::before {
                content: attr(data-label);
                display: block;
                font-weight: bold;
                color: #2a6496;
                font-size: 0.9rem;
                margin-bottom: 5px;
            }
            
            .expense-grid > div:nth-child(1)::before { content: "Expense Name"; }
            .expense-grid > div:nth-child(2)::before { content: "Amount"; }
            .expense-grid > div:nth-child(3)::before { content: "Frequency"; }
            .expense-grid > div:nth-child(4)::before { content: "Monthly Cost"; }
            .expense-grid > div:nth-child(5)::before { content: "Actions"; }

            input, select {
                padding: 12px 10px !important;
                font-size: 16px;
                margin-bottom: 5px;
            }

            .action-buttons {
                justify-content: flex-start;
                margin-top: 10px;
                gap: 10px;
            }
            
            .action-btn {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .calculator-container {
                padding: 15px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .category-header h2 {
                font-size: 1.3rem;
            }
            
            .retirement-section > div {
                grid-template-columns: 1fr !important;
                gap: 15px;
            }
            
            .multiplier-display {
                flex-direction: column;
            }
            
            .tooltip .tooltiptext {
                width: 200px;
                left: 50%;
                transform: translateX(-50%);
            }
            /* Income section specific styles */
            .category-section.income {
                border-left-color: #4f46e5;
                background-color: #f5f3ff;
            }

            #net-difference {
                font-weight: bold;
            }
        }
    
/* Percentage colouring */
.pct-badge { margin-left:8px; font-size:0.95em; }
.pct-ok   { color: #16a34a; font-weight: 600; }   /* green */
.pct-warn { color: #f59e0b; font-weight: 600; }   /* amber */
.pct-bad  { color: #dc2626; font-weight: 600; }   /* red */

/* Make tooltip align nicely when attached to percentage */
.tooltip.pct-tip { display: inline-block; margin-left: 6px; }
.tooltip.pct-tip .tooltiptext { width: 280px; }
</style>
</head>
<body>
<div class="calculator-container">
<div class="header-container">
<div style="display: flex; align-items: center; gap: 15px;">
<img alt="AITL Logo" src="AITLlogo.jpg" style="max-width: 200px; height: auto;"/>
<h1 style="margin: 0;">Dream Life Calculator</h1>
</div>
<a class="podcast-btn" href="https://linktr.ee/amitoolatepodcast" target="_blank">
            Listen to Podcast 🎧
        </a>
</div>
<div class="category-section income" style="margin-top: 20px;">
<div class="category-header">
<h2>Income Sources</h2>
</div>
<div class="expense-header">
<div>Income Source</div>
<div>Amount</div>
<div>Frequency</div>
<div>Monthly</div>
<div>Actions</div>
</div>
<!-- Pre-loaded Income Sources -->
<div class="expense-grid" data-category="income">
<div><input class="expense-name" type="text" value="Primary Salary"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="income">
<div><input class="expense-name" type="text" value="Side Income"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<button class="add-row-btn" data-category="income">+ Add Income Source</button>
</div>
<p>Enter your expenses below. All amounts will be converted to monthly and annual equivalents.</p>
<!-- NEEDS SECTION -->
<div class="category-section needs">
<div class="category-header">
<h2>Essential Needs</h2>
</div>
<div class="expense-header">
<div>Expense</div>
<div>Amount</div>
<div>Frequency</div>
<div>Monthly</div>
<div>Actions</div>
</div>
<!-- Pre-loaded Needs Expenses -->
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Rent or mortgage"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option value="weekly">Weekly</option>
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Property tax / council tax"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option value="monthly">Monthly</option>
<option selected="" value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Home insurance"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option value="monthly">Monthly</option>
<option selected="" value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Service charges / maintenance fees"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Utilities (electricity, gas, water)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Internet, TV licence"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Groceries"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="weekly">Weekly</option>
<option value="monthly">Monthly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Household supplies (cleaning, toiletries)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Pet food &amp; care"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Public transport passes"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Fuel"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="weekly">Weekly</option>
<option value="monthly">Monthly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="needs">
<div><input class="expense-name" type="text" value="Vehicle insurance"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option value="monthly">Monthly</option>
<option selected="" value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<!-- Moved Add Need button to bottom -->
<button class="add-row-btn" data-category="needs">+ Add Need</button>
</div>
<!-- WANTS SECTION -->
<div class="category-section wants">
<div class="category-header">
<h2>Lifestyle Wants</h2>
</div>
<div class="expense-header">
<div>Expense</div>
<div>Amount</div>
<div>Frequency</div>
<div>Monthly</div>
<div>Actions</div>
</div>
<!-- Pre-loaded Wants Expenses -->
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Eating out / takeaways / coffee"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="weekly">Weekly</option>
<option value="monthly">Monthly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Streaming services / paid TV"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Clothing &amp; shoes (beyond essentials)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Haircuts / beauty / grooming"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Hobbies &amp; leisure activities"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Gym / fitness classes / sports"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Education &amp; courses (non-essential)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Cultural activities (theatre, cinema, events)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Travel / weekend trips / holidays"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="annually">Annually</option>
<option value="monthly">Monthly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Subscriptions (apps, memberships, clubs)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="wants">
<div><input class="expense-name" type="text" value="Gifts (birthdays, holidays)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<!-- Moved Add Want button to bottom -->
<button class="add-row-btn" data-category="wants">+ Add Want</button>
</div>
<!-- FUTURE SECTION -->
<div class="category-section future">
<div class="category-header">
<h2>Savings / Future You</h2>
</div>
<div class="expense-header">
<div>Expense</div>
<div>Amount</div>
<div>Frequency</div>
<div>Monthly</div>
<div>Actions</div>
</div>
<!-- Pre-loaded Future Expenses -->
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Pension contributions"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Savings contributions (emergency fund, goals)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Investments"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Extra mortgage payments"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Debt overpayments (above minimum)"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Holiday / travel fund"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="weekly">Weekly</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<div class="expense-grid" data-category="future">
<div><input class="expense-name" type="text" value="Donations / charitable giving"/></div>
<div><input class="amount" placeholder="0" type="number"/></div>
<div>
<select class="frequency">
<option selected="" value="monthly">Monthly</option>
<option value="annually">Annually</option>
</select>
</div>
<div class="monthly">£0.00</div>
<div class="action-buttons">
<button class="action-btn move-up">↑</button>
<button class="action-btn move-down">↓</button>
<button class="action-btn del-row">×</button>
</div>
</div>
<!-- Moved Add Future button to bottom and renamed -->
<button class="add-row-btn" data-category="future">+ Add Future</button>
</div>
<div class="button-group">
<!-- PRO FEATURE: Export to CSV -->
<!-- (Will add export button next to Save Scenario) -->
<button class="btn" id="validate">Validate Inputs</button>
<button class="btn" id="reset">Reset All</button>
<button class="btn btn-secondary" id="save">Save Scenario</button>
<button class="btn btn-danger" id="clear-scenarios">Clear Scenarios</button>
</div>
<div id="validation-message" style="display:none; margin-top:10px; padding:10px; background:#fff3cd; border-radius:4px;"></div>
<div id="saved-scenarios" style="margin-top:20px; display:none;">
<!-- PRO FEATURE: Scenario Comparison Tool -->
<h3>Saved Scenarios</h3>
<div id="scenarios-list"></div>
</div>
<!-- Results Section -->
<div class="results" id="results">
<h3>Your Complete Lifestyle Costs. 
                <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">These totals reflect your current monthly and annual spending. Percentages next to Needs/Wants/Future show their share of your monthly income. Guidelines: 50/30/20 (Needs 50%, Wants 30%, Future 20%) or a modern 65/20/15 split.</span></span></h3>
<div class="total-row">
<span>Essential Needs:</span>
<span id="needs-total">£0.00</span><span class="pct-badge" id="needs-pct" style="margin-left:8px; font-size:0.95em; color:#666;">(0%)</span><span class="tooltip pct-tip"><span class="tooltip-icon">?</span><span class="tooltiptext" id="needs-pct-tip">Targets shown when calculated.</span></span>
</div>
<div class="annual-row">
<span>Annual Needs:</span>
<span id="needs-annual">£0.00</span>
</div>
<div class="total-row">
<span>Lifestyle Wants:</span>
<span id="wants-total">£0.00</span><span class="pct-badge" id="wants-pct" style="margin-left:8px; font-size:0.95em; color:#666;">(0%)</span><span class="tooltip pct-tip"><span class="tooltip-icon">?</span><span class="tooltiptext" id="wants-pct-tip">Targets shown when calculated.</span></span>
</div>
<div class="annual-row">
<span>Annual Wants:</span>
<span id="wants-annual">£0.00</span>
</div>
<div class="total-row">
<span>Savings / Future:</span>
<span id="future-total">£0.00</span><span class="pct-badge" id="future-pct" style="margin-left:8px; font-size:0.95em; color:#666;">(0%)</span><span class="tooltip pct-tip"><span class="tooltip-icon">?</span><span class="tooltiptext" id="future-pct-tip">Targets shown when calculated.</span></span>
</div>
<div class="annual-row">
<span>Annual Savings:</span>
<span id="future-annual">£0.00</span>
</div>
<div class="total-row" style="font-size: 1.2em; border-top: 2px solid #2a6496;">
<span>Total Monthly Cost:</span>
<span id="grand-total">£0.00</span>
</div>
<div class="annual-row" style="font-size: 1.1em;">
<span>Total Annual Cost:</span>
<span id="grand-annual">£0.00</span>
</div>
<div class="total-row" style="border-top: 2px solid #4f46e5; padding-top: 15px;">
<span>Total Monthly Income:</span>
<span id="income-total">£0.00</span>
</div>
<div class="annual-row">
<span>Annual Income:</span>
<span id="income-annual">£0.00</span>
</div>
<div class="total-row" style="color: #4f46e5;">
<span>Net Monthly Difference (Income - Expenses):</span>
<span id="net-difference">£0.00</span>
</div>
</div>
<div class="total-row" style="border-top: 2px solid #8b5cf6;">
<span>Your Savings Rate:</span>
<span id="savings-rate">0%</span>
</div>
<div style="text-align: center; margin: 25px 0;">
<button class="btn" onclick="showFutureFeatures(); return false;" style="background: linear-gradient(135deg, #8b5cf6, #4f46e5);" type="button">✨ Future Features 👀 (Coming Soon)</button>
</div>
<script>
</script>
<!-- RETIREMENT CALCULATOR -->
<div class="retirement-section">
<h3>Retirement Savings Target</h3>
<div class="inflation-note" style="background: #fff3cd; padding: 12px; border-radius: 6px; margin-top: 15px;">
<p style="margin: 0; font-size: 14px;">
            ⚠️ <strong>Note:</strong> All amounts shown are in today's pounds. 
            Remember inflation will reduce purchasing power over time. 
            Consider increasing your targets by 2-3% annually.
        </p>
</div>
<p>Based on your annual spending of <strong id="retirement-base">£0.00</strong>, you'll need:</p>
<!-- Multiplier Buttons -->
<!-- PRO FEATURE: Custom Retirement Multiplier Slider -->
<!-- (Will replace static buttons with dynamic input) -->
<div class="multiplier-display" style="margin-bottom: 25px;">
<div class="multiplier-badge active">
<h4>20× Multiple <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">A 5% withdrawal rate. This aggressive approach assumes higher risk or shorter retirement. £1 annually for every £20 saved.</span></span></h4>
<p id="retirement-20">£0.00</p>
<small>Conservative estimate</small>
</div>
<div class="multiplier-badge">
<h4>25× Multiple <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">Based on the 4% rule (Trinity Study). £1 annually for every £25 saved. Adjust for inflation.</span></span></h4>
<p id="retirement-25">£0.00</p>
<small>Recommended target</small>
</div>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; align-items: start;">
<!-- Retirement Tiers Column -->
<div style="display: flex; flex-direction: column; height: 100%;">
<div class="retirement-tiers" style="flex-grow: 1; padding-top: 0;">
<h4 style="margin-top: 0; padding-bottom: 5px; border-bottom: 1px solid #d1e3f8; font-size: 16px;">Retirement Lifestyle Tiers <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">These tiers represent different retirement lifestyles based on UK research. Minimum covers basic needs, Moderate adds some flexibility, Comfortable includes regular leisure activities, and Dream allows for luxury spending and travel.</span></span></h4>
<div class="tier minimum">
<span>Minimum: £58,000 (single) / No additional for a couple <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">Covers all your needs with some very basic wants. You'll have a no-frills retirement with state pension support.</span></span></span>
<small>Basic needs covered with state pension</small>
</div>
<div class="tier moderate">
<span>Moderate: £390,000 (single) / £400,000 (a couple)<span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">A more comfortable retirement with some leisure activities and occasional holidays, but still budget-conscious.</span></span></span>
<small>No-frills life with some flexibility</small>
</div>
<div class="tier comfortable">
<span>Comfortable: £650,000 (single) / £720,000 (a couple) <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">A comfortable retirement with regular leisure activities, holidays, and the ability to replace household goods when needed.</span></span></span>
<small>Travel and breathing room</small>
</div>
<div class="tier dream">
<span>Dream: £1M+ <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">Your ideal retirement lifestyle with luxury spending, frequent travel, and the ability to help family members financially.</span></span></span>
<small>Your ideal lifestyle</small>
</div>
</div>
</div>
<!-- Ways to Build Your Pot Column -->
<div style="display: flex; flex-direction: column; height: 100%;">
<div class="build-pot-section" style="background: #f0f7ff; padding: 20px; border-radius: 8px; flex-grow: 1; display: flex; flex-direction: column; padding-top: 0;">
<h4 style="font-size: 16px; margin-top: 0; padding-bottom: 5px; margin-bottom: 15px;">Ways to Build Your Pot</h4>
<div style="flex-grow: 1;">
<div>
<h5 style="color: #2a6496; margin: 0 0 8px 0; font-size: 14px;">1. Pensions</h5>
<ul style="margin: 0 0 15px 0; padding-left: 20px; font-size: 14px;">
<li style="margin-bottom: 5px;">Maximize workplace pension contributions</li>
<li style="margin-bottom: 5px;">Open a private SIPP pension</li>
<li style="margin-bottom: 5px;">Take full employer matching</li>
</ul>
</div>
<div>
<h5 style="color: #2a6496; margin: 0 0 8px 0; font-size: 14px;">2. Investments</h5>
<ul style="margin: 0 0 15px 0; padding-left: 20px; font-size: 14px;">
<li style="margin-bottom: 5px;">Global index funds (set-and-forget)</li>
<li style="margin-bottom: 5px;">Dividend-paying stocks</li>
<li style="margin-bottom: 5px;">Tax-efficient ISAs</li>
</ul>
</div>
<div>
<h5 style="color: #2a6496; margin: 0 0 8px 0; font-size: 14px;">3. Property</h5>
<ul style="margin: 0 0 15px 0; padding-left: 20px; font-size: 14px;">
<li style="margin-bottom: 5px;">Rental property income</li>
<li style="margin-bottom: 5px;">Downsizing your home</li>
<li style="margin-bottom: 5px;">Relocating to lower-cost areas</li>
</ul>
</div>
<div>
<h5 style="color: #2a6496; margin: 0 0 8px 0; font-size: 14px;">4. Side Hustles</h5>
<ul style="margin: 0 0 0 0; padding-left: 20px; font-size: 14px;">
<li style="margin-bottom: 5px;">Freelance/consulting work</li>
<li style="margin-bottom: 5px;">Passive income streams</li>
<li style="margin-bottom: 5px;">Part-time work in retirement</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div> <!-- Closing calculator-container div -->
<script>
        document.addEventListener('DOMContentLoaded', function() {
            // Debugging: Log feature usage (visible in console only)
            console.log('Calculator loaded. Future paid features mapped.');

            // PERFECT FREQUENCY CONVERSIONS
            function convertToMonthly(amount, frequency) {
                amount = parseFloat(amount) || 0;
                switch(frequency) {
                    case 'weekly': return amount * (52 / 12);  // Weekly → Monthly
                    case 'annually': return amount / 12;       // Annual → Monthly
                    case 'monthly': 
                    default: return amount;                    // Monthly stays same
                }
            }
            
            // Format currency nicely
            function formatCurrency(amount) {
                return '£' + amount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }
            
            // Calculate retirement targets
            function calculateRetirement(annualSpending) {
                document.getElementById('retirement-base').textContent = formatCurrency(annualSpending);
                document.getElementById('retirement-20').textContent = formatCurrency(annualSpending * 20);
                document.getElementById('retirement-25').textContent = formatCurrency(annualSpending * 25);
            }
            
            // Add new expense row to specified category
            function addNewExpenseRow(category) {
                const section = document.querySelector(`.category-section.${category}`);
                const expenseGrids = section.querySelectorAll('.expense-grid');
                const lastRow = expenseGrids[expenseGrids.length - 1];
                
                const newRow = lastRow.cloneNode(true);
                
                // Reset values
                newRow.querySelector('.expense-name').value = '';
                newRow.querySelector('.amount').value = '';
                newRow.querySelector('.monthly').textContent = '£0.00';
                
                // Reset frequency options (weekly, monthly, annually available for all categories)
                const freqSelect = newRow.querySelector('.frequency');
                freqSelect.innerHTML = `
                    <option value="weekly">Weekly</option>
                    <option value="monthly" selected>Monthly</option>
                    <option value="annually">Annually</option>
                `;
                
                // Insert after last row
                lastRow.parentNode.insertBefore(newRow, lastRow.nextSibling);
                
                // Set up action buttons and event listeners
                setupRowActions(newRow);
                newRow.querySelector('.amount').addEventListener('input', calculateTotals);
                newRow.querySelector('.frequency').addEventListener('change', calculateTotals);
                
                // Focus on the new expense name field
                newRow.querySelector('.expense-name').focus();
            }

            // Reset all inputs to default
            function resetAll() {
                document.querySelectorAll('.expense-grid').forEach(row => {
                    // Clear the expense name if it's not one of the pre-loaded defaults
                    const nameInput = row.querySelector('.expense-name');
                    if (!nameInput.value || nameInput.value.trim() === '') {
                        nameInput.value = '';
                    }
                    
                    // Reset amount to empty
                    row.querySelector('.amount').value = '';
                    
                    // Reset frequency to monthly (or the original default)
                    const frequencySelect = row.querySelector('.frequency');
                    if (row.closest('.needs') && nameInput.value.includes('Property tax')) {
                        frequencySelect.value = 'annually'; // Special case for property tax
                    } else if (row.closest('.needs') && (nameInput.value.includes('Groceries') || nameInput.value.includes('Fuel'))) {
                        frequencySelect.value = 'weekly'; // Special case for groceries/fuel
                    } else if (row.closest('.wants') && nameInput.value.includes('Eating out')) {
                        frequencySelect.value = 'weekly'; // Special case for eating out
                    } else {
                        frequencySelect.value = 'monthly'; // Default
                    }
                    
                    // Reset monthly display
                    row.querySelector('.monthly').textContent = '£0.00';
                });
                
                // Recalculate to show all zeros
                calculateTotals();
            }
            
            // Setup row action buttons
            // Setup row action buttons
            function setupRowActions(row) {
                const moveUpBtn = row.querySelector('.move-up');
                const moveDownBtn = row.querySelector('.move-down');
                const delBtn = row.querySelector('.del-row');
                const section = row.closest('.category-section');
                
                // Clear any existing event listeners by cloning the buttons
                moveUpBtn.replaceWith(moveUpBtn.cloneNode(true));
                moveDownBtn.replaceWith(moveDownBtn.cloneNode(true));
                delBtn.replaceWith(delBtn.cloneNode(true));
                
                // Get fresh references to the cloned buttons
                const newMoveUp = row.querySelector('.move-up');
                const newMoveDown = row.querySelector('.move-down');
                const newDel = row.querySelector('.del-row');
                
                // Add new event listeners
                newMoveUp.addEventListener('click', function() {
                    const prev = row.previousElementSibling;
                    if (prev && prev.classList.contains('expense-grid')) {
                        row.parentNode.insertBefore(row, prev);
                        calculateTotals();
                    }
                });
                
                newMoveDown.addEventListener('click', function() {
                    const next = row.nextElementSibling;
                    if (next && next.classList.contains('expense-grid')) {
                        row.parentNode.insertBefore(next, row);
                        calculateTotals();
                    }
                });
                
                newDel.addEventListener('click', function() {
                    if (section.querySelectorAll('.expense-grid').length > 1) {
                        row.remove();
                        calculateTotals();
                    } else {
                        alert("Each category must have at least one expense item. Add a new one before deleting this.");
                    }
                });
            }
            
            // Main calculation function
            function calculateTotals() {
                let needsTotal = 0;
                let wantsTotal = 0;
                let futureTotal = 0;
                let incomeTotal = 0;
                    
                    // Process all expense rows
                document.querySelectorAll('.expense-grid').forEach(row => {
                    const amount = parseFloat(row.querySelector('.amount').value) || 0;
                    const frequency = row.querySelector('.frequency').value;
                    const monthlyDisplay = row.querySelector('.monthly');
                    
                    // Calculate monthly amount
                    const monthlyAmount = convertToMonthly(amount, frequency);
                    monthlyDisplay.textContent = formatCurrency(monthlyAmount);
                    
                    // Add to appropriate total
                    const category = row.closest('.category-section').classList[1];
                    if (category === 'needs') needsTotal += monthlyAmount;
                    else if (category === 'wants') wantsTotal += monthlyAmount;
                    else if (category === 'future') futureTotal += monthlyAmount;
                });
                // Calculate income totals
                document.querySelectorAll('.expense-grid[data-category="income"]').forEach(row => {
                    const amount = parseFloat(row.querySelector('.amount').value) || 0;
                    const frequency = row.querySelector('.frequency').value;
                    const monthlyDisplay = row.querySelector('.monthly');
                    
                    const monthlyAmount = convertToMonthly(amount, frequency);
                    monthlyDisplay.textContent = formatCurrency(monthlyAmount);
                    incomeTotal += monthlyAmount;
                });
                // Calculate savings rate (after incomeTotal is calculated)    
                    const savingsRate = (futureTotal / incomeTotal * 100).toFixed(1);
                    document.getElementById('savings-rate').textContent = 
        `               ${isNaN(savingsRate) ? '0' : savingsRate}%`;

                // Calculate annual totals
                const grandTotal = needsTotal + wantsTotal + futureTotal;
                const grandAnnual = grandTotal * 12;
                
                // Update the display
                document.getElementById('needs-total').textContent = formatCurrency(needsTotal);
                document.getElementById('wants-total').textContent = formatCurrency(wantsTotal);
                document.getElementById('future-total').textContent = formatCurrency(futureTotal);
                document.getElementById('grand-total').textContent = formatCurrency(grandTotal);
                
                document.getElementById('needs-annual').textContent = formatCurrency(needsTotal * 12);
                document.getElementById('wants-annual').textContent = formatCurrency(wantsTotal * 12);
                document.getElementById('future-annual').textContent = formatCurrency(futureTotal * 12);
                document.getElementById('grand-annual').textContent = formatCurrency(grandAnnual);
                
                document.getElementById('income-total').textContent = formatCurrency(incomeTotal);
                document.getElementById('income-annual').textContent = formatCurrency(incomeTotal * 12);

                // Calculate net difference
                const netDifference = incomeTotal - grandTotal;
                document.getElementById('net-difference').textContent = formatCurrency(netDifference);
                document.getElementById('net-difference').style.color = netDifference >= 0 ? '#22c55e' : '#ef4444';
                
                
                // Update category percentages as a share of income (guideline basis)
                function safePct(part, whole) {
                    if (!whole || isNaN(part) || isNaN(whole)) return '0%';
                    const p = Math.round((part / whole) * 100);
                    return p + '%';
                }

                function pctNumber(part, whole) {
                    if (!whole || isNaN(part) || isNaN(whole)) return 0;
                    return Math.round((part / whole) * 100);
                }
                function closestTarget(pct, targets) {
                    // targets = [{label:'50/30/20', needs:50, wants:30, future:20}, {...}]
                    let best = { name: '', diff: 1e9, t: {} };
                    for (const t of targets) {
                        const diff = Math.min(
                            Math.abs(pct.needs - t.needs),
                            Math.abs(pct.wants - t.wants),
                            Math.abs(pct.future - t.future)
                        );
                        if (diff < best.diff) best = { name: t.name, diff, t };
                    }
                    return best;
                }
                function colourClass(delta) {
                    // +/-5% = ok (green), +/-10% = warn (amber), else bad (red)
                    if (delta <= 5) return 'pct-ok';
                    if (delta <= 10) return 'pct-warn';
                    return 'pct-bad';
                }
                function updatePctUI(needsPct, wantsPct, futurePct) {
                    var needsPctEl = document.getElementById('needs-pct');
                    var wantsPctEl = document.getElementById('wants-pct');
                    var futurePctEl = document.getElementById('future-pct');

                    // Remove previous colour classes
                    [needsPctEl, wantsPctEl, futurePctEl].forEach(function(el){
                        if(!el) return;
                        el.classList.remove('pct-ok','pct-warn','pct-bad');
                    });

                    // Targets to compare
                    const targets = [
                        { name: '50/30/20', needs:50, wants:30, future:20 },
                        { name: '65/20/15', needs:65, wants:20, future:15 }
                    ];
                    const current = { needs: needsPct, wants: wantsPct, future: futurePct };

                    // Pick the closest scheme by overall "feel", but show per-line deltas
                    const best = closestTarget(current, targets);

                    // Compute deltas to the chosen scheme
                    const deltas = {
                        needs: Math.abs(needsPct - best.t.needs),
                        wants: Math.abs(wantsPct - best.t.wants),
                        future: Math.abs(futurePct - best.t.future),
                    };

                    // Apply class and text
                    function setPct(el, pct, delta, tipId, targetValue) {
                        if (!el) return;
                        el.textContent = ' (' + (isNaN(pct) ? '0' : pct) + '%)';
                        el.classList.add(colourClass(delta));
                        var tipEl = document.getElementById(tipId);
                        if (tipEl) {
                            const dir = pct > targetValue ? 'over' : (pct < targetValue ? 'under' : 'on target');
                            tipEl.textContent = 'Closest guideline: ' + best.name +
                              '. Target: ' + targetValue + '%. You are ' +
                              (dir === 'on target' ? 'on target.' : dir + ' by ' + Math.abs(pct - targetValue) + '%.');
                        }
                    }

                    setPct(needsPctEl, needsPct, deltas.needs, 'needs-pct-tip', best.t.needs);
                    setPct(wantsPctEl, wantsPct, deltas.wants, 'wants-pct-tip', best.t.wants);
                    setPct(futurePctEl, futurePct, deltas.future, 'future-pct-tip', best.t.future);
                }
                    var needsPctEl = document.getElementById('needs-pct');
                var wantsPctEl = document.getElementById('wants-pct');
                var futurePctEl = document.getElementById('future-pct');
                if (needsPctEl) needsPctEl.textContent = ' (' + safePct(needsTotal, incomeTotal) + ')';
                if (wantsPctEl) wantsPctEl.textContent = ' (' + safePct(wantsTotal, incomeTotal) + ')';
                if (futurePctEl) futurePctEl.textContent = ' (' + safePct(futureTotal, incomeTotal) + ')';
    
                // Update retirement calculator
                calculateRetirement(grandAnnual);
            }

            function validateInputs() {
                let emptyFields = [];
                document.querySelectorAll('.expense-grid').forEach(row => {
                    const name = row.querySelector('.expense-name').value.trim();
                    const amount = row.querySelector('.amount').value.trim();
                    if (name && !amount) {
                        emptyFields.push(name);
                        row.style.backgroundColor = '#fff3cd';
                        setTimeout(() => row.style.backgroundColor = '', 2000);
                    }
                });

                const messageBox = document.getElementById('validation-message');
                if (emptyFields.length > 0) {
                    messageBox.innerHTML = `
                        <strong>⚠ Missing amounts for:</strong>
                        <ul>${emptyFields.map(item => `<li>${item}</li>`).join('')}</ul>
                        <small>These will calculate as £0 if left blank</small>
                    `;
                    messageBox.style.display = 'block';
                } else {
                    messageBox.innerHTML = '<strong>✓ All inputs have values</strong>';
                    messageBox.style.display = 'block';
                    setTimeout(() => messageBox.style.display = 'none', 2000);
                }
            }

            function saveScenario() {
                const now = new Date();
                const scenario = {
                    timestamp: now.toLocaleString(),
                    needs: document.getElementById('needs-total').textContent,
                    wants: document.getElementById('wants-total').textContent,
                    future: document.getElementById('future-total').textContent,
                    monthly: document.getElementById('grand-total').textContent,
                    annual: document.getElementById('grand-annual').textContent,
                    retirement: document.getElementById('retirement-25').textContent
                };
                
                const list = document.getElementById('scenarios-list');
                list.insertAdjacentHTML('afterbegin', `
                    <div class="saved-scenario">
                        <h4>Scenario ${list.children.length + 1} <small>(${scenario.timestamp})</small></h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>Needs: ${scenario.needs}</div>
                            <div>Wants: ${scenario.wants}</div>
                            <div>Future: ${scenario.future}</div>
                            <div>Retirement: ${scenario.retirement}</div>
                        </div>
                        <div style="margin-top: 8px; font-weight: bold;">
                            Total: ${scenario.monthly} (${scenario.annual} annually)
                        </div>
                    </div>
                `);
                
                document.getElementById('saved-scenarios').style.display = 'block';
            }

            function clearScenarios() {
                if (confirm("Are you sure you want to clear all saved scenarios?")) {
                    document.getElementById('scenarios-list').innerHTML = '';
                    document.getElementById('saved-scenarios').style.display = 'none';
                }
            }

            // Initialize all existing rows
            document.querySelectorAll('.expense-grid').forEach(row => {
                setupRowActions(row);
                row.querySelectorAll('.amount, .frequency').forEach(input => {
                    input.addEventListener('input', calculateTotals);
                });
            });
            
            // Set up event listeners for "Add" buttons
            document.querySelectorAll('.add-row-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    addNewExpenseRow(category);
                });
            });
            
            // Button event listeners
            document.getElementById('validate').addEventListener('click', validateInputs);
            document.getElementById('reset').addEventListener('click', resetAll);
            document.getElementById('save').addEventListener('click', saveScenario);
            document.getElementById('clear-scenarios').addEventListener('click', clearScenarios);
           
            // Multiplier badge click handlers
            /*
            document.querySelectorAll('.multiplier-badge').forEach(badge => {
                badge.addEventListener('click', function() {
                    document.querySelectorAll('.multiplier-badge').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            */
            
            // Initial calculation
            calculateTotals();
        });
    </script>
<style>
  .podcast-float {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #2a6496;
    color: white;
    padding: 15px 25px;
    border-radius: 50px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 100;
    text-decoration: none;
    display: flex;
    align-items: center;
    font-size: 18px;
    font-weight: bold;
    transition: all 0.3s;
  }
  .podcast-float:hover {
    background: #1d4b7a;
    transform: scale(1.05);
  }
  .podcast-float span {
    margin-right: 10px;
  }
</style>
<script>
(function(){
  function popupMsg() {
    alert(
      "✨ Future Features 👀\n\n" +
      "Here’s a sneak peek at what I’m building:\n" +
      "• Flexible retirement age planning\n" +
      "• Lifestyle scenarios (minimum, comfortable, dream)\n" +
      "• Smarter tax-friendly options\n" +
      "• Long-term dashboards & projections\n\n" +
      "These tools aren’t live yet, but they’re on the roadmap.\n" +
      "Got an idea? I’d love to hear it — no promises, but I’m listening!"
    );
  }
  // canonical names
  window.showFutureFeatures = popupMsg;
  window.showProTeaser = popupMsg; // keep legacy alias as a reminder hook
})();
</script>
</body>
</html>
